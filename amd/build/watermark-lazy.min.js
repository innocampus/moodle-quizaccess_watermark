define ("quizaccess_watermark/watermark-lazy",["exports","jquery"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var h=regeneratorRuntime.mark(f);function c(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function d(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function e(a,b,c){if(b)d(a.prototype,b);if(c)d(a,c);return a}var i="",j="",k=function(a,c,d,e,f){if(a){i+=String.fromCodePoint(917626);j+=String.fromCodePoint(8292)}i+=o(c,16,917601,4);j+=o(c,8,8288,2);(0,b.default)(".que.shortanswer .answer input, .que.calculated .answer input, .que.calculatedsimple .answer input, .que.numerical .answer input, .que.multianswer .subquestion input").each(function(a,b){new p(b)});(0,b.default)("<input>").attr({type:"hidden",name:"quizaccess_watermark_enable_clean",value:"1"}).appendTo("#responseform");g(c,d,e,f)};a.init=k;var l=function(a){var b=1,c=2,d=0,e="",f=a[Symbol.iterator](),g=f.next(),h="";while(!g.done){if(d===0){if(!n(g.value)){e+=j}d=c}else if(d===b){if(!m(g.value)){e+=i}d=c}else{if(" "===g.value){if(!n(h)){e+=j}d=b}e+=g.value;h=g.value;g=f.next()}}if(!m(e.codePointAt(e.length-2))){e+=i}return e},m=function(a){if("string"==typeof a||a instanceof String){a=a.codePointAt(0)}return 917504<=a&&917631>=a},n=function(a){if("string"==typeof a||a instanceof String){a=a.codePointAt(0)}return 8288<=a&&8292>=a},o=function(a,b,c,d){for(var e="",f=0,g;f<b;f++){g=parseInt(a.charAt(f),16);if(4===d){e+=String.fromCodePoint(c+g)}else if(2===d){e+=String.fromCodePoint(c+(3&g>>2));e+=String.fromCodePoint(c+(3&g))}}return e},p=function(){function a(d){var e=this;c(this,a);this.field=d;this.dirty=!0;this.addWatermark();(0,b.default)(d).on("input",function(){e.dirty=!0});(0,b.default)(d).keydown(function(a){if("ArrowLeft"===a.key){a.preventDefault();e.moveSelection("l",a.shiftKey)}else if("ArrowRight"===a.key){a.preventDefault();e.moveSelection("r",a.shiftKey)}else if("Backspace"===a.key){e.deleteChar("l")}else if("Delete"===a.key){e.deleteChar("r")}});(0,b.default)(d).blur(function(){e.addWatermark()});(0,b.default)(d).select(function(){if(e.field.selectionStart!==e.field.selectionEnd){e.addWatermark()}})}e(a,[{key:"addWatermark",value:function addWatermark(){if(this.dirty){this.field.value=l(this.field.value);this.dirty=!1}}},{key:"moveSelection",value:function moveSelection(a,b){var c=this.field.value,d=this.field.selectionStart,e=this.field.selectionEnd,f="l"===a?d:e,g=this.getPosNextVisibleChar(c,f,a);if(b&&"l"===a){this.field.setSelectionRange(g,e)}else if(b&&"r"===a){this.field.setSelectionRange(d,g)}else{this.field.setSelectionRange(g,g)}}},{key:"deleteChar",value:function deleteChar(a){if(this.field.selectionStart===this.field.selectionEnd){this.moveSelection(a,!0)}}},{key:"getPosNextVisibleChar",value:function getPosNextVisibleChar(a,b,c){var d="r"===c?1:-1;b+=d;for(;b<a.length&&0<b;b+=d){var e=a.codePointAt(b);if(56320==(64512&e)){continue}if(m(e)||n(e)){continue}return b}return Math.max(0,b)}}]);return a}();function f(a){var b,c;return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:b=0;case 1:if(!(b<a.length)){d.next=14;break}c=parseInt(a[b],16);d.next=5;return 1&c>>3;case 5:d.next=7;return 1&c>>2;case 7:d.next=9;return 1&c>>1;case 9:d.next=11;return 1&c;case 11:b++;d.next=1;break;case 14:d.next=17;return 0;case 17:d.next=14;break;case 19:case"end":return d.stop();}}},h)}function g(a,c,d,e){for(var g=f(a),h="<svg version=\"1.1\" viewBox=\"0 0 90 90\" xmlns=\"http://www.w3.org/2000/svg\">\n<rect x=\"0\" y=\"0\" width=\"90\" height=\"90\" fill=\"".concat(c,"\"/>\n<rect x=\"1\" y=\"10\" width=\"1\" height=\"1\" fill=\"").concat(d,"\"/>"),i=10;90>i;i+=10){for(var k=10;90>k;k+=10){if(0<g.next().value){h+="<rect x=\"".concat(k,"\" y=\"").concat(i,"\" width=\"1\" height=\"1\" fill=\"").concat(e,"\"/>")}}}h+="</svg>";var j="<style>.que .formulation {\n        background-repeat: repeat;\n        background-size: 90px 90px;\n        background-image: url(data:image/svg+xml;base64,".concat(btoa(h),");\n    }</style>");(0,b.default)(j).appendTo("head")}});
//# sourceMappingURL=watermark-lazy.min.js.map
